# Step 000006: Intelligent Snippet Extraction

## Overview
Implement context-aware code snippet extraction that shows complete logical units (functions, classes) instead of arbitrary character truncations.

## Context
The current system shows the first 300 characters of files, which often cuts off mid-sentence or mid-function. For optimal AI agent understanding, we need snippets that respect code boundaries and provide meaningful context.

## Implementation Tasks

### 1. Language-Aware Parsing
- Create `snippet_extractor.py` module
- Implement basic AST parsing for major languages:
  - Python: functions, classes, imports
  - JavaScript/TypeScript: functions, classes, exports
  - Java: methods, classes, packages
  - Go: functions, structs, packages

### 2. Intelligent Boundary Detection
- Find the complete function/class containing the matched content
- Extract meaningful imports and dependencies
- Handle edge cases (global variables, module-level code)
- Fall back to line-based extraction for unsupported languages

### 3. Multi-Snippet Support
- Extract multiple relevant code sections from the same file
- Rank snippets by relevance to the search query
- Ensure snippets don't overlap or duplicate information
- Limit total snippet size while maximizing context

### 4. Line Number Integration
- Include precise line number references for IDE navigation
- Track start and end lines for each extracted snippet
- Support `file:line` URL format for direct IDE opening
- Maintain snippet context even with line number changes

## Success Criteria
- [ ] Snippets show complete functions/classes instead of arbitrary truncations
- [ ] Line numbers accurately reflect snippet boundaries
- [ ] Multiple relevant snippets are extracted from the same file when appropriate
- [ ] Extraction works for Python, JavaScript, and at least one other language
- [ ] Graceful fallback for unsupported languages or parsing errors

## Files to Create/Modify
- `snippet_extractor.py` - New module for intelligent extraction
- `search_operations.py` - Integrate snippet extraction into search
- `search_result_types.py` - Update data classes to support multi-snippet results
- `tests/test_snippet_extraction.py` - Test extraction accuracy

## Dependencies
- Step 000005 must be completed (search result data structures)

## Technical Notes
- Use language-specific AST libraries (ast for Python, acorn for JS, etc.)
- Consider using Tree-sitter for unified parsing across languages
- Balance snippet size vs. context - aim for 10-50 lines of meaningful code
- Handle syntax errors gracefully with fallback extraction

## Estimated Effort
6-8 hours