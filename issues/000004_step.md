# Step 000004: Language Detection and File Metadata Extraction

## Overview
Implement intelligent language detection and metadata extraction for code files during the indexing process.

## Context
Building on the schema extensions from Step 000003, we need to populate the new metadata columns with intelligent file analysis during indexing.

## Implementation Tasks

### 1. Language Detection Module
- Create `language_detection.py` module
- Implement file extension to language mapping
- Add content-based language detection for ambiguous files
- Handle multi-language files (e.g., HTML with embedded JS/CSS)

### 2. File Metadata Extraction
- Extend `indexing_operations.py` to extract file metadata
- Calculate file size and line count during processing
- Detect file type from extension and content analysis
- Add support for detecting framework-specific files (React components, Django models, etc.)

### 3. Integration with Indexing Pipeline
- Update the indexing process to populate new metadata columns
- Ensure backward compatibility with existing indexing workflow
- Add progress indicators for metadata extraction

### 4. Language-Specific Processing
- Implement basic language-specific file categorization:
  - Source code files (.py, .js, .java, etc.)
  - Configuration files (.json, .yaml, .toml, etc.)
  - Documentation files (.md, .rst, .txt, etc.)
  - Build/deployment files (Dockerfile, requirements.txt, etc.)

## Success Criteria
- [ ] Language detection works accurately for common programming languages
- [ ] File metadata is extracted correctly during indexing
- [ ] Existing indexing performance is not significantly degraded
- [ ] New metadata is populated for both fresh indexes and re-indexing

## Files to Create/Modify
- `language_detection.py` - New module for language detection
- `indexing_operations.py` - Update to extract metadata
- `tests/test_language_detection.py` - Test language detection accuracy
- `tests/test_metadata_extraction.py` - Test metadata extraction

## Dependencies
- Step 000003 must be completed (schema extensions)

## Technical Notes
- Use file extension as primary indicator, content analysis as fallback
- Consider using `pygments` library for advanced language detection
- Cache language detection results to avoid repeated processing
- Handle binary files gracefully (skip content analysis)

## Estimated Effort
4-5 hours